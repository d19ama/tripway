# @seller-mfe/app-analytics

> BFF, построенный на базе [NestJs](https://docs.nestjs.com/)

### # Команды

| name        | description                                                |
| ----------- | ---------------------------------------------------------- |
|             | **УТИЛИТЫ**                                                |
| prepare     | Установка зависимостей для разработки                      |
|             | **СБОКА ПРОЕКТА**                                          |
| build       | Собирает проект, в папку **dist**                          |
|             | **РАЗРАБОТКА ПРОЕКТА**                                     |
| start:dev   | Запустить в режиме разработки                              |
| start:debug | Запустить в режиме разработки и запуском инспектора кода   |
|             | **ФОРМАТИРОВАНИЕ ПРОЕКТА**                                 |
| format      | Запускает форматирование кода по правилам prettier         |
| lint        | Запуск eslint                                              |
|             | **ТЕСТИРОВАНИЕ ПРОЕКТА**                                   |
| test        | Запуск тестов                                              |
| test:cov    | Запуск тестов и получение статистики по проекту (coverage) |
| test:e2e    | End to ENd тестирование                                    |

### # Разработка

1. Ставим зависимости `npm i`
2. Ставим зависимости для разработки `npm run prepare`
3. Запускаем разработку `npm run start:dev` или `npm run start:debug`

- После запуска будет доступен host http://localhost:3005
- swagger доступен по адресу http://localhost:3005/api/v1

### # Продуктовая сборка

1. Ставим зависимости `npm i`
2. Собираем проект `npm run build`
3. Запускаем сборку `npm run start:prod`

- После запуска будет доступен host http://localhost:3005
- swagger доступен по адресу /api/analytics/api/v1

### # Архитектура

Здесь нету чистой архитектуры или DDD - здесь задана архитектура для демо. В момент разработки надо принять решение, какую архитектуру использовать.
На текущий момент тут все просто, устроенно.

#### > Базовые файлы и папки

- **main.ts** => главный файл запуска сервера
- **app.module.ts** => файл инициализации модулей
- **shared** => общий функционал на проект
  - **decorators** => общие декораторы
  - **guards** => общие ограничения
  - **redis.module** => модуль подключения к редису

#### > Остальные папки

Остальные папки являются SCOPE(Сущность, кому проще), которые не общаются между другими SCOPE, но могут использовать **shared** элементы.

Взято из [примера](https://github.com/nestjs/nest/tree/master/sample/11-swagger/src).

- **{SCOPE}**
  - **{SCOPE}.module.ts** => модуль инициализации, текущего SCOPE. Обязательный файл
  - **{SCOPE}.controller.ts** => список контрактов. Обязательный файл
  - **{SCOPE}.service.ts** => сервис, который вызывается в контроллере (Кто-то называет UseCase). Могут вызываться несколько сервисов в контроллере!!!
  - **dto/\*** => DTO, необходимые для SCOPE. Название файлов по маске **{\*}.dto.ts**
  - **entities/\*** => Сущности, необходимые для SCOPE. Название файлов по маске **{\*}.entity.ts**
